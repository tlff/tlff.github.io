(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{430:function(t,a,e){"use strict";e.r(a);var p=e(65),s=Object(p.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("编辑于:2019年2月15日")]),t._v(" "),e("h2",{attrs:{id:"安装依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[t._v("#")]),t._v(" 安装依赖")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("yum "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y libxml2 libxml2-devel libcurl libcurl-devel "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nlibpng libpng-devel freetype-devel libxslt libxslt-devel  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nlibjpeg  libjpeg-devel freetype \n")])])]),e("h2",{attrs:{id:"安装php"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装php"}},[t._v("#")]),t._v(" 安装PHP")]),t._v(" "),e("ul",[e("li",[t._v("官网下载PHP")]),t._v(" "),e("li",[t._v("解压")]),t._v(" "),e("li",[t._v("配置参数 编译 安装")])]),t._v(" "),e("h2",{attrs:{id:"配置参数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置参数"}},[t._v("#")]),t._v(" 配置参数")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("//成功\n./configure "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/php73 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--enable-fpm --with-config-file-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/ "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-libxml-dir --with-openssl  --with-zlib "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-curl --with-freetype-dir --with-gd --enable-mbstring --with-mysqli "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--enable-pcntl --enable-zip --with-libzip"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/libzip "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-pdo-mysql "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n--with-jpeg-dir --with-png-dir --with-freetype-dir --with-zlib-dir\n")])])]),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("//没试过\n./configure --prefix=/usr/local/php \\\n--with-curl --with-freetype-dir --with-gd \\\n--with-gettext --with-iconv-dir --with-kerberos \\\n--with-libdir=lib64 --with-libxml-dir --with-mysqli \\\n--with-openssl --with-pcre-regex --with-pdo-mysql \\\n--with-pdo-sqlite --with-pear --with-png-dir --with-jpeg-dir \\\n--with-xmlrpc --with-xsl --with-zlib --with-bz2 --with-mhash \\\n--enable-fpm --enable-bcmath --enable-libxml --enable-inline-optimization \\\n--enable-mbregex --enable-mbstring --enable-opcache --enable-pcntl \\\n--enable-shmop --enable-soap --enable-sockets --enable-sysvsem \\\n--enable-sysvshm --enable-xml --enable-zip --with-libzip=/usr/local/libzip\n\n\n//确认没错之后\nmake && make install\n")])])]),e("h2",{attrs:{id:"将php和php-fpm加入环境变量"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#将php和php-fpm加入环境变量"}},[t._v("#")]),t._v(" 将php和php-fpm加入环境变量")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("//查看环境变量\necho $PATH\n//删除旧的php和php-fpm\n//创建软连接\nln -s /usr/local/php73/bin/php /usr/bin/php\nln -s /usr/local/php73/sbin/php-fpm /usr/bin/php-fpm\n")])])]),e("h2",{attrs:{id:"让nginx使用新的php"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#让nginx使用新的php"}},[t._v("#")]),t._v(" 让nginx使用新的php")]),t._v(" "),e("p",[t._v("因为PHP使用php-fpm管理的nginx只是监听127.0.0.1:9000这个端口,所以有两个方法可以让nginx使用新的PHP")]),t._v(" "),e("ol",[e("li",[t._v("关了旧的php-fpm,使用新的php-fpm")]),t._v(" "),e("li",[t._v("修改nginx监听的端口同时修改fpm配置中的端口,启动新的php-fpm")])]),t._v(" "),e("h2",{attrs:{id:"配置php-fpm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置php-fpm"}},[t._v("#")]),t._v(" 配置php-fpm")]),t._v(" "),e("p",[t._v("编译安装的php-fpm在/usr/local/php73/sbin,默认的配置文件在/usr/local/php73/etc中")]),t._v(" "),e("p",[t._v("从默认配置文件创建一个配置文件")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" /usr/local/php73/etc/php-fpm.conf.default /usr/local/php73/etc/php-fpm.conf\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" /usr/local/php73/etc/php-fpm.d/www.conf.default /usr/local/php73/etc/php-fpm.d/www.conf\n")])])]),e("p",[t._v("修改www.conf中的user和group 为nginx")]),t._v(" "),e("h2",{attrs:{id:"安装php途中遇到的问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装php途中遇到的问题"}},[t._v("#")]),t._v(" 安装php途中遇到的问题")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("configure: error: off_t undefined; check your library configuration")]),t._v(" "),e("p",[t._v("解决:将libzip加入的ld path中 并在设置参数的时候指定libzip的安装目录")])]),t._v(" "),e("li",[e("p",[t._v("遇到某些扩展没有 一般安装这个扩展和 扩展-devel版本")])])]),t._v(" "),e("h3",{attrs:{id:"编译安装libzip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编译安装libzip"}},[t._v("#")]),t._v(" 编译安装libzip")]),t._v(" "),e("p",[t._v("yum中自带的libzip版本太低只能手动装了")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("wget https://nih.at/libzip/libzip-1.2.0.tar.gz\ntar -zxvf libzip-1.2.0.tar.gz\ncd libzip-1.2.0\n./configure --prefix=/usr/local/libzip\nmake && make install\n//将libzip加入到系统的ld path中 后面这句是刷新缓存\necho '/usr/local/libzip/lib' >> /etc/ld.so.conf && ldconfig\n")])])])])}),[],!1,null,null,null);a.default=s.exports}}]);